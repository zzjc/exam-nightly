 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<link href="/Public/artDialog/skins/opera.css" rel="stylesheet" />
<script src="/Public/js/jquery.js"></script>
<script src="/Public/artDialog/artDialog.js"></script>
<script src="/Public/artDialog/plugins/iframeTools.source.js"></script>
<script type="text/javascript" src="/Public/js/textext.js"></script>
<script charset="utf-8" type="text/javascript" src="/Public/editor/kindeditor.js"></script>
<script charset="utf-8" type="text/javascript" src="/Public/editor/lang/zh_CN.js"></script>
	 <script>
        var editor;
        var origin=artDialog.open.origin;
        var setsType=art.dialog.data("setsType");
        $(function(){
            var keditor;
            KindEditor.ready(function(K) {
                keditor=K.create('#editor_id');
                editor=keditor;
            });
            var test_type=origin.$("input[name='test_type'][type='radio']:checked").val();
            switch(test_type)
   　     　{
  　　         case "1":
   　　            $("#answer").html("<span>答案:</span>"+
                                     "<input type='radio' name='answer[]' value='A'>A"+
                                     "<input type='radio' name='answer[]' value='B'>B"+
                                     "<input type='radio' name='answer[]' value='C'>C"+
                                     "<input type='radio' name='answer[]' value='D'>D");        
                    break;
               case "2":
                    $("#answer").html("<span>答案:</span>"+
                                      "<input type='checkbox' name='answer[]' value='A'>A"+
                                      "<input type='checkbox'name='answer[]' value='B'>B"+
                                      "<input type='checkbox' name='answer[]' value='C'>C"+
                                      "<input type='checkbox' name='answer[]' value='D'>D");         
                    break;
                case "3":
                     $("#answer").html("<span>答案:</span>"+
                                       "<input type='radio' name='answer[]' value='A'>对"+
                                       "<input type='radio'name='answer[]' value='B'>错");       
                     break;
                case "4":
                  switch(setsType){
                    case "1":
                      $("#answer").html("<span>答案:</span>"+
                        "<input type='radio' name='answer[]' value='A'>A"+
                        "<input type='radio' name='answer[]' value='B'>B"+
                        "<input type='radio' name='answer[]' value='C'>C"+
                        "<input type='radio' name='answer[]' value='D'>D");        
                    break;
                    case "2":
                      $("#answer").html("<span>答案:</span>"+
                        "<input type='checkbox' name='answer[]' value='A'>A"+
                        "<input type='checkbox'name='answer[]' value='B'>B"+
                        "<input type='checkbox' name='answer[]' value='C'>C"+
                        "<input type='checkbox' name='answer[]' value='D'>D");         
                      break;
                    case "3":
                     $("#answer").html("<span>答案:</span>"+
                        "<input type='radio' name='answer[]' value='A'>对"+
                        "<input type='radio'name='answer[]' value='B'>错");       
                     break;
                  }
　　        }             
        })
    /*
      *添加知识点
    */
    function addAspects(){
      var cat_id=origin.$("#name").val();
      art.dialog.data("cat_id",cat_id);
      art.dialog.open("/Tpl/default/Admin/Test/addAspects.html",{title:"添加知识点"});
    }
    //判断题目类型和输出题目具体信息
		function sub(){
			var aspects=document.getElementById('aspects_name').value;
            var answerMulti=$("input[name='answer[]'][type='checkbox']:checked");
            var answerSingle=$("input[name='answer[]'][type='radio']:checked").val();
            if(answerMulti!=""){
                var multiAnswer="";
                for(var i=0;i<answerMulti.length;i++){
                    multiAnswer+=answerMulti[i].value;   
                 }
            }
			var answer=answerSingle?answerSingle:multiAnswer;
			var point=document.getElementById('point').value;
			var question=editor.html();
      var level=$("#difficult").val();
      var author=$("#author").val();
			var detailOb=origin.$("#titleDetail");
			detailOb.append("<div class='rule_done'><p>问题:"+question+
                            "</p><p>知识点:"+aspects+
                            "</p><span class='detailSplit'>分数:"+point+
                            "</span><span class='detailSplit'>答案:"+answer+
                            "</span><span class='detailSplit'>难度:"+level+
                            "</div>");
      var title_hide=$("<div class='title_hide'>"+
                          "<input type='hidden' name='content[]' value='"+question+"'/>"+
                          "<input type='hidden' name='name[]' value='"+aspects+"'/>"+
                          "<input type='hidden' name='answer[]' value='"+answer+"'/>"+
                          "<input type='hidden' name='point[]' value='"+point+"'/>"+
                          "<input type='hidden' name='level[]' value='"+level+"'/>"+
                          "<input type='hidden' name='setsType[]' value='"+setsType+"'/>"+
                        "</div>");
      detailOb.append(title_hide);
			art.dialog.close();
		}    



	 </script>
</head>
<body>
<p>请输入题干:<textarea id='editor_id' style="width:480px"></textarea></p>
<div>
  <div><textarea id="aspects" rows="1" name="aspects" style="width:480px"></textarea></div>
  <div><input type="button" onclick="addAspects()" value="添加知识点"></div>
</div>
<div id="answer"></div>
<p><span>分数:</span><input type="text" id="point"></p>
<p>
    难度：<select id="difficult" name="level">
         	  <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>          
</p>
<p><input type="button" onclick="sub()" id="exit" value="确定规则"></p>
</body>
</html>
<script type="text/javascript">
    $('#aspects').textext({
        plugins : 'tags prompt focus autocomplete ajax arrow',
        tagsItems : "",
        prompt : '选择知识点...',
        html: {
            hidden: '<input type="hidden" id="aspects_name" />'
        },
        ajax : {
            url : '/Data/aspects/1.json?' + parseInt(Math.random()*100000000),
            dataType : 'json',
            cacheResults : false
        }
    });
</script>